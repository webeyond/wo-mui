<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../../css/base.css" />
		<link rel="stylesheet" type="text/css" href="../../css/mui.picker.css" />
	</head>

	<body>
		<!--<header class="mui-bar mui-bar-nav" id="nav_bg">
		<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
		<h1 class="mui-title" id="title">添加收货地址</h1>
	</header>-->
		<div class="mui-content">
			<ul class="mui-table-view" id="public_ul" style="margin-bottom: 15px;">
				<li class="mui-table-view-cell">
					<label for="">姓名</label>
					<input type="text" />
				</li>
				<li class="mui-table-view-cell">
					<label for="">身份证</label>
					<input type="text" />
				</li>
				<li class="mui-table-view-cell">
					<label for="">联系电话</label>
					<input type="text" />
				</li>
			</ul>
			<div style="height: 40px;"><span style="line-height: 20px;margin-left: 15px;">请选择号码</span></div>
			<ul class="mui-table-view" id="public_ul">

				<li class="mui-table-view-cell">
					<label for="">收货地址</label>
					<input type="text" id="showAddress" />
				</li>
			</ul>
			<button class="button" id="btn">提 交</button>
		</div>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/mui.picker.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/mui.poppicker.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/city.data-3.js" type="text/javascript" charset="utf-8"></script>

		<Script>
			mui.init();
			var btn = document.getElementById('btn');
			var input = document.getElementsByTagName('input');
			var title = document.getElementById('title');

			input['0'].value = localStorage.getItem('aname');
			input['1'].value = localStorage.getItem('aphone');
			input['2'].value = localStorage.getItem('aaddress');
			input['3'].value = localStorage.getItem('azcode');

//			var aid = localStorage.getItem('aid');
//
//			if(aid) {
//				title.innerHTML = '修改收货地址';
//			} else {
//				title.innerHTML = '添加收货地址';
//			}

			btn.addEventListener('tap', function() {
				var name = input['0'].value;
				var phone = input['1'].value;
				var address = input['2'].value;
				var zcode = input['3'].value;
				if(name == '') {
					mui.toast('收件人不能为空');
					return;
				}
				if(phone == '') {
					mui.toast('手机号码不能为空');
					return;
				}
				if(phone.length != 11) {
					mui.toast('手机号码位数不正确');
					return;
				}
				if(address == '') {
					mui.toast('收货地址不能为空');
					return;
				}
				if(zcode == '') {
					mui.toast('邮编不能为空');
					return;
				}

				var request_url = localStorage.getItem('dongyiweidian_request_url');
				var login_phone = localStorage.getItem('dongyiweidian_login');
				mui.get(request_url + 'User/add_address', {
					name_data: name,
					phone_data: phone,
					address_data: address,
					zcode_data: zcode,
					login_phone_data: login_phone,
					aid_data: aid
				}, function(data) {
					if(data == 1) {

						//调用地址列表页面，展示我们的地址
						mui.plusReady(function() {

							var address_list = plus.webview.getWebviewById('user_address');
							mui.fire(address_list, 'get_address', {});

							var car = plus.webview.getWebviewById('car');
							mui.fire(car, 'get_address', {});

							mui.toast('提交成功');
							mui.back();
						});

					} else {
						mui.toast('提交失败,请重试');
					}

				}, 'json');

			});

			mui.plusReady(function() {
				document.getElementById('showAddress').addEventListener('tap', function() {

					var adressStr = '';
					//显示几层，我们要显示省、市、区，所以我们这里写三层，如果不写默认是一层
					var addressPicker = new mui.PopPicker({
						layer: 3
					});
					addressPicker.setData(cityData3);
					//city.data-3.js中的数据

					addressPicker.show(function(selectItems) {
						//将选择的省、市、区显示到屏幕上
						for(var i = 0; i < selectItems.length; i++) {
							adressStr += selectItems[i].text;
						}
						document.getElementById('showAddress').innerHTML = adressStr;
					});
				})
			});
		</Script>

	</body>

</html>